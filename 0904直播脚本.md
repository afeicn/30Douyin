# 0904直播脚本

## Trae七周实战训练营——第五课：如何用好数据？用AI构建数据分析仪表盘

### 一、课程导引

#### 飞哥：
大家好，欢迎大家来到Trae七周实战训练营的第五节课，我是你们的老朋友沈飞。

#### 刘泓：
大家好，我是今天的主讲人刘泓。

#### 飞哥：
我们先回顾一下前几节课的内容。此前我们通过vibe coding的方式搭建了小游戏的前后端和数据库，实现了用户注册、登录和数据存储等功能，并且拥有了第一批用户。
但是今天我要问大家一个问题：
**🎬 01-展示当前游戏后台数据**
作为游戏运营人员，看到这些密密麻麻的数据表，你能快速回答出：
● 用户最活跃的时间段是什么时候？
● 哪些玩家是我们的核心用户？
● 游戏的难度设置是否合理？
● 用户的留存情况如何？

如果老板问你这些问题，你是不是只能一脸懵逼？应该如何在数据库中查询这些数据呢？

#### 刘泓：
现在我们可以使用sql的查询语句来查询这些数据。
例如，要查询用户的最常玩的时间段，我们可以使用如下语句：
```
SELECT play_time FROM users ORDER BY play_time DESC LIMIT 1;
```

#### 飞哥：
没错，我们可以通过sql从数据库中查询这些数据，但是大家想一想，这样会给游戏运营带来什么问题？（评论区互动）
1. 每次都需要通过sql语句来查询，消耗时间和精力；
2. 数据分析方式不灵活，难以进行多维度的数据分析
3. 数据分析结果无法可视化，难以理解和分享。

因此，今天我们来进一步剖析数据处理问题，让大家学会用好数据，用数据说话。

我们之前学习了数据存储、数据库，知道了如何将前端交互产生的数据通过后端程序存储到数据库中，但这其实只是数据流转中的一个环节。
现在请大家暂时忘记“数据库”，我们从数据处理的全流程从头讲起。

#### 刘泓：
在数据科学中，工作流程包括以下几个关键步骤：
1.数据准备：这是数据分析的起点，涉及收集、清洗和整理数据，以确保数据的可靠性和可用性。
2.数据分析：在此阶段，数据分析师将运用各种统计方法和算法，对准备好的数据进行深入挖掘和分析。
3.结果反馈：分析完成后，需要向业务团队或利益相关者呈现分析结果，并根据反馈进行必要的调整和优化。
4.方法传播：将成功的数据分析方法和模型进行总结和传播，以便团队其他成员能够学习和借鉴。

以上步骤很好理解，那么如何将它们抽象成系统架构呢？

首先先来明确我们的需求。对于应用软件中产生的数据，我们需要：
1. 记录数据：记录业务运营中的各种数据、用户行为数据、系统日志等，确保数据的完整性和准确性，让业务能够正常开展；
2. 分析数据：包括用户行为分析、业务指标分析等，帮助业务团队了解用户需求、业务运营情况、业务问题等，为业务决策提供支持。
3. 数据处理：从记录到分析之间，还需要有一个过渡性的数据准备工作，将原始数据加工为可以进行数据分析的格式，包括数据的清洗和格式转换等。

**🎬 02-展示数据处理流程图**
以上三个步骤分别对应OLTP、OLAP 和 ETL 这三个概念，三者构成一个完整的数据处理流程。
本节课我们将详细介绍这三个概念，并且通过vibe coding的方式，搭建一个完整的数据处理流程。

#### 飞哥：
在现在这个数字化的时代，数据对企业的价值是实实在在的，说它是核心资产一点不为过。企业每天产生的数据量巨大，但要怎么管好、用好这些数据，确实是不少管理者面临的难题。
今天我们要解决的就是"让数据开口说话"的问题，把冰冷的数字变成生动的图表和洞察！通过本节课的学习，大家可以掌握数据分析的基本原理和数据处理的流程。

今天在过程中我们会出3道选择题，还是采用抽奖的形式，每次答题前三名的同学会进入抽奖池，在直播最后再从这9位同学中抽取出3位获奖。
今天的抢答礼物是——小米智能音箱。
同时互动最多的同学会获得——车模积木玩具。

### 二、知识点：OLTP、OLAP 和 ETL 
#### 刘泓：
在数据处理领域，OLAP (联机分析处理) 和 OLTP (联机事务处理) 是两个非常关键又常常被对比的概念。
那么，OLAP 到底指的是什么？它跟 OLTP 具体有哪些不同？别急，咱们今天就把这两个概念讲清楚。

**🎬 03-展示OLTP概念图**
OLTP（联机事务处理）
1. 目的： 主要用于处理日常的、实时的业务操作和事务。
2. 工作方式： 专注于高效地执行高并发的增、删、改、查操作。它要求数据操作具有原子性、一致性、隔离性和持久性（ACID）。
3. 应用场景：
● 电商网站的下单、支付、订单查询。
● 银行的转账、取款、账户余额查询。
● 社交媒体发布动态、点赞、评论。
4. 数据库特点：
● 面向行存储，因为每次事务只涉及少量行的数据。
● 通常使用关系型数据库，比如我们之前学习的MySQL，还有PostgreSQL、Oracle等。
5. 核心要求：
● 处理具体的业务操作
● 要求速度快、准确性高
● 每次处理少量数据
● 支持大量用户同时操作

你可以把 OLTP 理解为：超市的收银系统，它需要快速、准确地完成每一笔交易。

**🎬 04-展示OLAP概念图**
OLAP（联机分析处理）
1. 目的： 主要用于数据分析和决策支持。
2. 工作方式： 专注于对海量的历史数据进行复杂的聚合、统计和查询。它不关心单条数据的增删改，而是通过多维度的分析来发现数据背后的规律和趋势。
3. 应用场景：
● 市场经理分析不同地区、不同时间段的商品销售额。
● 管理层查看公司的季度利润报表。
● 数据分析师对用户行为进行深度挖掘。
4. 数据库特点：
● 通常采用列式存储，因为分析查询通常只涉及少数几个列，这种存储方式能极大提高查询效率。
● 通常使用分析型数据库或数据仓库，如 ClickHouse、Apache Doris、Hive。
5. 核心要求：
● 分析历史数据找规律
● 处理大量历史数据
● 生成统计报告和图表
● 支持复杂的数据查询

你可以把 OLAP 理解为：超市的总部管理系统，它用来分析所有门店、所有商品的销售数据，以决定未来的采购和营销策略。

**🎬 05-展示游戏OLTP & OLAP对比图**
对于我们的游戏来说：
游戏的OLTP场景（日常运行）：
● 用户登录游戏 → 验证用户名密码
● 用户玩游戏结束 → 记录分数到排行榜
● 查看个人历史 → 显示用户的游戏记录
● 查看排行榜 → 显示TOP10玩家

这些都是"做事情"的操作，要求快速响应！

游戏的OLAP场景（数据分析）：
● 分析用户活跃时间：什么时候玩家最多？
● 用户留存分析：新用户第二天还会回来吗？
● 游戏难度分析：平均分数分布是否合理？
● 用户价值分析：哪些是我们的核心玩家？

这些都是"分析数据"的操作，要求深度洞察！

#### 飞哥：
这两者之间的关系是什么？

#### 刘泓：
它们是不同职能的协作关系：
● OLTP系统负责生产数据，专心处理日常业务；
● OLAP系统专门做数据分析，负责利用数据创造价值。

#### 飞哥：
我们来一道抢答题测试一下！
**🎬 05-展示抢答题1**
```
抢答题1：以下哪些属于OLTP操作？
    - A. 用户登录游戏
    - B. 提交游戏分数
    - C. 分析用户月活跃度
    - D. 查看个人排行榜

  答案：A、B、D
```

#### 飞哥：
刚才讲到OLTP和OLAP使用的是不同的数据库系统，那么数据是如何从OLTP系统传输到OLAP系统的呢？

#### 刘泓：
这就需要引入第三个概念——数据处理流程ETL。

**🎬 06-展示ETL概念图**
数据从OLTP系统传输到OLAP系统的过程通常称为ETL（Extract, Transform, Load）。

E - Extract（提取）：
从业务系统中提取原始数据
● 就像从仓库中取出原材料

T - Transform（转换）：  
清洗、计算、聚合数据
● 就像在工厂中加工原材料

L - Load（加载）：
把处理好的数据放入分析系统
● 就像把成品放入展示柜

对于我们的游戏来说：
● 提取：从users表、leaderboard表中获取原始数据
● 转换：计算用户活跃度、游戏时长统计、分数分布等
● 加载：把分析结果放入专门的分析表中

#### 飞哥：
还记得刚才这张流程图吗？
**🎬 07-展示数据处理流程图**
OLTP、OLAP 和 ETL 这三个概念，构成了一个完整的数据处理流程：
1.数据产生：业务运营中的各种数据通过 OLTP 系统产生和记录。
2.数据流通：ETL 工具负责将 OLTP 系统中的原始数据，经过清洗和转换，定期或实时地传输到数据仓库。
3.数据消费：数据分析师和业务用户使用 OLAP 工具，在数据仓库上进行多维分析，为商业决策提供支持。

以上就是本节课的知识讲解部分，大家理解了吗？学会了请在评论区扣1，有问题的小伙伴可以在评论区留言。
接下来是第二道抢答题！

**🎬 08-展示抢答题2**
```
抢答题2：ETL过程中的"T"（Transform）阶段主要做什么？
    - A. 从数据库中提取原始数据
    - B. 对数据进行清洗、计算和聚合
    - C. 将处理后的数据加载到目标系统
    - D. 创建数据备份
  答案：B 

```

### 三、实操环节

#### 飞哥：
接下来进入实操环节：用Trae给贪吃蛇小游戏搭建一个仪表盘。
那么我们应该如何写提示词呢？
如果没有明确的需求，可以直接告诉AI：“给贪吃蛇小游戏搭建一个仪表盘”，这样AI其实会通过自己的思考，来进行数据分析和展示。
但是很多时候，这样全盘交给AI的话，生成的结果可能不符合我们的需求，所以最好还是先想好数据分析需求。

在这里，我先给大家普及一下数据分析的基本知识：
数据分析的本质就是从一个或多个维度，对指标进行切分、聚合、对比，从而发现业务规律、问题和机会的过程。

**🎬 09-展示数据分析维度表**
常用的数据分析的维度包括：
1. 时间维度：这是最重要的维度之一，用于分析趋势、周期和变化。
粒度：年、季度、月、周、日、小时、分钟、秒。

2. 地理/区域维度：分析数据在不同地区的分布差异。
粒度：国家、省份、城市、区县、街道、甚至具体经纬度。

3. 用户/客户维度：也称为用户画像，是理解“谁”在产生数据的关键。
示例：分析“不同年龄层”用户的付费偏好，或“高价值用户”的行为特征。

4. 产品/商品维度：分析业务所提供的产品或服务本身。
示例：分析“各个品类”的销售额贡献度，或“不同价格带”商品的销量。

5. 渠道/来源维度：分析用户或业务来自哪里。
示例：分析“不同广告渠道”的投入产出比，或“iOS和Android用户”的留存率差异。

6. 行为/事件维度：分析用户做了什么具体动作。
属性：事件类型（点击、购买、浏览、点赞）、事件属性（点击了哪个按钮、购买了哪件商品、浏览了多久）。
示例：分析“加入购物车”到“生成订单”的转化率，或用户“浏览路径”的漏斗模型。

在实际分析中，我们一般不会只使用一个维度，而是通过多维交叉分析来挖掘深层洞察。
1. 单一维度：时间维度 -> 查看公司近一年的总销售额趋势。
2. 两个维度交叉：时间维度 × 产品维度 -> 查看每个季度中各个品类的销售额变化，找出哪个品类在哪个季度表现最好。
3. 三个维度交叉：时间维度 × 产品维度 × 地域维度 -> 查看2025年Q2，某产品在北京地区的销量是否出现了预期中的爆发式增长。
4. 维度下钻：从“年”数据下钻到“月”再到“日”，比如从“中国”下钻到“北京市”再到“海淀区”，不断细化以定位问题。

以上就是数据分析的基本维度，大家理解了吗？

在具体进行数据分析时，如何选择正确的维度：
1. 紧扣业务目标：你的分析目的是什么？想解决什么问题？比如，目标是提升用户留存，那就聚焦“用户行为”、“用户画像”维度。
2. 数据可得性：无论是单一维度还是复合维度，我们要能够获取到其中需要的数据。
3. 避免维度过多：维度过多会导致数据复杂性增加，分析结果也会变得模糊。一般建议控制在3个维度以内。

接下来请泓老师以小游戏为示例讲解一下实操步骤。

#### 刘泓：
**🎬 投屏演示**
现在我要告诉AI我们的数据分析需求。关键是要用业务语言描述问题：

```
我们的贪吃蛇游戏现在有用户系统和游戏记录，作为运营人员，我想了解：

【当前数据情况】
- users表：存储用户基本信息
- leaderboard表：存储每次游戏的分数记录
- 但我们只能看到原始数据，无法快速获得运营洞察

【我想要的分析功能】
1. 用户活跃度分析：
   - 每日活跃用户数趋势
   - 用户游戏时段分布热力图
   
2. 游戏表现分析：
   - 用户分数分布情况
   - 平均游戏时长统计
   - 高分玩家占比

3. 用户价值分析：
   - 用户游戏频次排名
   - 新用户留存率
   - 活跃用户贡献度

请帮我构建一个数据分析仪表盘，能够：
- 自动从现有数据中提取分析指标
- 用图表直观展示分析结果
- 支持按时间筛选查看趋势
```

看！我们用业务语言描述了OLAP需求，AI就知道要做什么了！

（点击发送，等待AI回复）

太棒了！AI理解了我们的数据分析需求！让我们看看AI的解决方案！


AI为我们设计了完整的数据分析系统：

1. 数据收集增强（扩展OLTP数据）：
```sql
-- 新增用户行为记录表
CREATE TABLE user_sessions (
    id INTEGER PRIMARY KEY,
    user_id INTEGER,
    login_time DATETIME,
    logout_time DATETIME,
    game_count INTEGER,
    total_score INTEGER,
    session_duration INTEGER  -- 会话时长（分钟）
);
```

2. 数据分析表（OLAP专用表）：
```sql
-- 日活跃度统计表
CREATE TABLE daily_analytics (
    date DATE,
    total_users INTEGER,
    active_users INTEGER,
    new_users INTEGER,
    avg_session_time INTEGER,
    total_games_played INTEGER
);

-- 小时活跃度统计表  
CREATE TABLE hourly_analytics (
    date DATE,
    hour INTEGER,
    active_users INTEGER,
    avg_score FLOAT
);
```

3. ETL数据处理逻辑：
```python
# 每日数据汇总
def daily_etl():
    # 提取：从业务表获取原始数据
    raw_data = db.execute("""
        SELECT user_id, DATE(created_at) as date, score
        FROM leaderboard 
        WHERE DATE(created_at) = CURRENT_DATE
    """)
    
    # 转换：计算分析指标
    daily_stats = {
        'total_users': count_unique_users(raw_data),
        'avg_score': calculate_avg_score(raw_data),
        'total_games': len(raw_data)
    }
    
    # 加载：保存到分析表
    db.execute("""
        INSERT INTO daily_analytics (date, total_users, avg_score, total_games)
        VALUES (?, ?, ?, ?)
    """, daily_stats)
```

4. 数据可视化界面：
AI还生成了漂亮的仪表盘页面，包括：
● 折线图：显示日活跃用户趋势
● 柱状图：显示分数分布情况  
● 热力图：显示用户活跃时段
● 饼图：显示用户价值分层

#### 飞哥：
接下来今天的最后一道抢答题！
**🎬 10-展示抢答题3**
```
抢答题3：数据分析系统处理的主要是什么类型的数据？
    - A. 实时的、当前的数据
    - B. 历史的、聚合的数据
    - C. 原始的、未处理的数据
    - D. 临时的、缓存的数据
  答案：B
```

### 四、部署
#### 飞哥：
现在让我们把AI生成的数据分析系统部署起来，看看实际效果！

#### 刘泓：
**🎬 投屏演示**

部署步骤：
1. 创建新的分析数据表
2. 部署ETL数据处理脚本  
3. 添加数据可视化页面
4. 配置定时任务自动更新数据

（演示实际操作过程）

现在让我们测试分析效果！

测试1：模拟用户行为数据
为了有足够的数据进行分析，我先添加一些模拟数据...
（添加测试数据）

测试2：运行ETL处理
现在运行数据处理脚本，看看原始数据如何转换成分析结果...
（展示ETL运行过程）

测试3：查看分析仪表盘
太棒了！让我们看看生成的数据分析结果！

看！现在我们可以快速了解：

用户活跃度分析：
● 日活跃用户：昨天15人，今天32人，增长113%！
● 最活跃时段：晚上7-9点，白天较少

游戏表现分析：
● 平均分数：156分，说明游戏难度适中
● 高分玩家（>200分）占比：23%，游戏有挑战性

用户价值分析：
● 核心用户（游戏>10次）：8人，贡献了60%的活跃度
● 新用户留存率：75%，表现不错

#### 飞哥：
这些数据洞察对游戏运营有什么帮助呢？

#### 刘泓：
基于这些数据，我们可以做出明智的运营决策：

1. 发现问题：
● 白天活跃度低 → 可以推出"午休小游戏"活动
● 25%用户没有回访 → 需要改进新手引导
● 高分玩家占比不高 → 可以增加游戏难度或添加挑战模式

2. 验证效果：
● 推出新功能后，通过数据看用户反应
● A/B测试不同的游戏设置
● 监控关键指标的变化趋势

3. 制定策略：
● 在活跃高峰期推送重要消息
● 针对不同价值用户制定差异化策略
● 基于数据预测未来发展趋势

这就是数据驱动的运营！

### 五、总结
#### 飞哥：
今天的信息量很大，请泓老师给我们总结一下核心要点。

#### 刘泓：
**🎬 11-展示知识点总结**

今天我们学会了：
1. 数据处理流程：
    1. 数据产生：业务运营中的各种数据通过 OLTP 系统产生和记录。
    2. 数据流通：ETL 工具负责将 OLTP 系统中的原始数据，经过清洗和转换，定期或实时地传输到数据仓库。
    3. 数据消费：数据分析师和业务用户使用 OLAP 工具，在数据仓库上进行多维分析，为商业决策提供支持。
2. 数据分析方法：
    1. 分析维度：时间、地理、用户、产品、渠道、行为维度
    2. 数据洞察分析：单一维度、多维度、数据下钻
3. 通过Vibe Coding搭建数据分析仪表盘：梳理数据分析需求，用业务语言描述问题。

最重要的是：我们从"数据存储者"升级为了"数据洞察者"！

#### 飞哥：
现在我们的游戏不仅有完整的功能，还有强大的数据分析能力！但是我想到一个问题：如果我们的游戏用户量暴增，服务器压力过大怎么办？系统性能如何监控和优化呢？

#### 刘泓：
没错！下期我们将学习系统性能监控和优化——构建完整的运维监控体系，确保游戏稳定运行！

#### 飞哥：
**🎬 12-展示课后作业说明**
本周的课后作业：为你们之前的作品制作一个数据分析仪表盘。要求：
1. 设计至少3个分析指标
2. 创建简单的ETL数据处理流程  
3. 制作基础的数据可视化展示

**🎬 13-展示抽奖界面**
接下来进入抽奖环节！本周获奖者是——xxx、xxx、xxx
最后揭晓今天的互动榜第一，是xxx，将获得本期礼品一份。

记得完成我们的课后测验和作业，及时巩固自己的学习效果，下周同一时间我们不见不散！





### 测验题目

一、单选题

  1. OLTP系统的主要特点是什么？
    - A. 处理大量历史数据进行分析
    - B. 快速处理具体的业务操作
    - C. 生成统计报表和图表
    - D. 支持复杂的数据查询
  答案：B
 
  2. ETL过程中的"T"（Transform）阶段主要做什么？
    - A. 从数据库中提取原始数据
    - B. 对数据进行清洗、计算和聚合
    - C. 将处理后的数据加载到目标系统
    - D. 创建数据备份
  答案：B 

  3. ETL过程中，哪个阶段负责从业务系统获取原始数据？
    - A. Extract（提取）
    - B. Transform（转换）
    - C. Load（加载）
    - D. Analysis（分析）
  答案：A
 
  4. 数据分析系统处理的主要是什么类型的数据？
    - A. 实时的、当前的数据
    - B. 历史的、聚合的数据
    - C. 原始的、未处理的数据
    - D. 临时的、缓存的数据
  答案：B

二、多选题

  1. 以下哪些属于OLTP操作？
    - A. 用户登录游戏
    - B. 提交游戏分数
    - C. 分析用户月活跃度
    - D. 查看个人排行榜
  答案：A、B、D
  
  2. 完整的ETL过程包括哪些步骤？
    - A. Extract（提取）原始数据
    - B. Transform（转换）和清洗数据
    - C. Load（加载）到目标系统
    - D. Delete（删除）原始数据
  答案：A、B、C

  3. 数据可视化图表类型包括以下哪些？
    - A. 折线图显示日活跃用户趋势
    - B. 柱状图显示分数分布情况
    - C. 热力图显示用户活跃时段
    - D. 饼图显示用户价值分层
  答案：A、B、C、D

三、判断题（6道）

  1. ETL过程完全由技术人员编程实现，非技术人员无法参与数据分析需求的设计。
  答案：错误

  2. 数据分析仪表盘主要展示实时的、当前的业务数据，以便快速处理用户请求。
  答案：错误


  3.OLAP系统的主要作用是快速处理用户登录、游戏分数提交等日常业务操作。
  答案：错误


